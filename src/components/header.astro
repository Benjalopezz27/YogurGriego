---
import "../../src/global.css";
import "../global.css";
---

<!-- Overlay que difumina el resto de la página -->
<div
  id="menuOverlay"
  class="fixed inset-0 bg-black/30 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300 z-40"
>
</div>

<header
  id="site-header"
  class="flex justify-center items-center py-3 sm:py-5 md:py-8 w-full mx-auto px-6 sticky top-0 z-50 backdrop-blur-sm"
>
  <div class="w-full max-w-[1200px] flex items-center justify-end">
    <!-- logo / marca -->

    <!-- botón toggle (visible en pantallas pequeñas) -->
    <button
      id="menuToggle"
      aria-expanded="false"
      aria-controls="navMenu"
      class="xl:hidden text-gray-700 hover:text-red-400 transition-colors duration-200"
    >
      ☰
    </button>

    <!-- menú integrado (ya no es <nav>) -->
    <div
      id="navMenu"
      role="navigation"
      class="absolute top-full left-0 w-full flex flex-col items-center gap-y-4 py-6
             transform scale-y-0 opacity-0 transition-all duration-300 origin-top z-50
             xl:static xl:opacity-100 xl:scale-y-100 xl:flex-row xl:gap-x-10 xl:py-0 xl:w-auto"
    >
      <a href="#inicio" class="nav-link">Inicio</a>
      <a href="#contacto" class="nav-link">Contacto</a>
      <a href="#beneficios" class="nav-link">Beneficios</a>
      <a href="#recetas" class="nav-link">Recetas</a>
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById("menuToggle");
  const menu = document.getElementById("navMenu");
  const overlay = document.getElementById("menuOverlay");

  function openMenu() {
    if (menu && overlay && toggle) {
      menu.classList.remove("scale-y-0", "opacity-0");
      menu.classList.add("scale-y-100", "opacity-100");
      overlay.classList.remove("opacity-0", "pointer-events-none");
      overlay.classList.add("opacity-100", "pointer-events-auto");
      toggle.setAttribute("aria-expanded", "true");
    }
  }

  function closeMenu() {
    if (menu && overlay && toggle) {
      menu.classList.remove("scale-y-100", "opacity-100");
      menu.classList.add("scale-y-0", "opacity-0");
      overlay.classList.remove("opacity-100", "pointer-events-auto");
      overlay.classList.add("opacity-0", "pointer-events-none");
      toggle.setAttribute("aria-expanded", "false");
    }
  }

  if (toggle && menu && overlay) {
    toggle.addEventListener("click", () => {
      const expanded = toggle.getAttribute("aria-expanded") === "true";
      if (expanded) closeMenu();
      else openMenu();
    });

    // click en overlay cierra
    overlay.addEventListener("click", closeMenu);

    // Esc para cerrar
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeMenu();
    });

    // opcional: cerrar al hacer click en un link del menú (útil en mobile)
    menu.querySelectorAll("a").forEach((link) =>
      link.addEventListener("click", () => {
        // solo cerrar en pantallas pequeñas
        if (window.matchMedia("(max-width: 1279px)").matches) closeMenu();
      })
    );
  }
</script>
